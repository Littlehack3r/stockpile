---

- id: 93648730-e433-4a96-aaab-b28e247a75a8
  name: Change Background
  description: Changes wallpaper of the client desktop
  tactic: execution
  technique:
    attack_id: T1059
    name: Command-Line Interface
  platforms:
    windows:
      psh:
        command: |
          try{
              #$path = "C:\Users\" + $env:USERNAME + "\Pictures\" + "test.jpg"
              $path = "C:\Users\" + $env:USERNAME + "\Pictures\wow.jpg"
              (IWR -Uri "https://i.imgur.com/K7sE8BL.png" -OutFile $path)
              #(IWR -Uri "https://github.com/NotoriousRebel/RedSharp/blob/master/kali.png" -OutFile $path)
            }
          Catch{

          }
          #Write-Host "Path: $Path"
          #$path = "C:\Users\test\Pictures\wow.jpg"
          $setwallpapersrc = @"
          using System.Runtime.InteropServices;
          public class wallpaper
          {
          public const int SetDesktopWallpaper = 20;
          public const int UpdateIniFile = 0x01;
          public const int SendWinIniChange = 0x02;
          [DllImport("user32.dll", SetLastError = true, CharSet = CharSet.Auto)]
          private static extern int SystemParametersInfo (int uAction, int uParam, string lpvParam, int fuWinIni);
          public static void SetWallpaper ( string path )
          {
          SystemParametersInfo( SetDesktopWallpaper, 0, path, UpdateIniFile | SendWinIniChange );
          }
          }
          "@
          Add-Type -TypeDefinition $setwallpapersrc
          [wallpaper]::SetWallpaper($path)
          